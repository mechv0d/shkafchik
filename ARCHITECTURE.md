# Архитектура проекта "Шкафчик"

## Обзор

Проект "Шкафчик" - мобильное приложение для управления гардеробом, разработанное с использованием **React Native** и **Expo**. Проект использует архитектурный подход **Feature-Sliced Design (FSD)** для обеспечения масштабируемости, поддерживаемости и четкого разделения ответственностей.

## Архитектурный подход: Feature-Sliced Design (FSD)

### Почему FSD?

FSD был выбран по следующим причинам:

1. **Масштабируемость**: Позволяет легко добавлять новые фичи без нарушения существующего кода
2. **Разделение ответственностей**: Четкое разделение по слоям и бизнес-областям
3. **Поддержка роста команды**: Каждый разработчик может работать в своем слое без конфликтов
4. **Простота понимания**: Логичная структура, легко ориентироваться новым разработчикам
5. **Соответствие React**: Хорошо сочетается с принципами React и компонентной архитектурой

### Сравнение с альтернативами

| Аспект                         | FSD      | Layered Architecture | Clean Architecture |
| ------------------------------ | -------- | -------------------- | ------------------ |
| **Сложность внедрения**        | Средняя  | Низкая               | Высокая            |
| **Масштабируемость**           | Высокая  | Средняя              | Высокая            |
| **Разделение по доменам**      | Отличное | Слабое               | Отличное           |
| **Поддержка командной работы** | Отличная | Хорошая              | Отличная           |
| **Для solo-разработчика**      | Подходит | Подходит             | Переусложнено      |

## Структура проекта

```
src/
├── app/                 # Инициализация приложения
│   ├── _layout.tsx      # Корневой layout
│   ├── App.tsx          # Главный компонент приложения
│   ├── global.css       # Глобальные стили
│   ├── index.tsx        # Точка входа
│   └── providers/       # Провайдеры (QueryClient, Context)
│       └── QueryProvider.tsx
├── pages/               # Страницы приложения
│   ├── home/            # Главная страница
│   └── [другие страницы]
├── widgets/             # Крупные UI блоки
│   ├── search-header/   # Виджет поиска
│   ├── bottom-navigation/ # Нижняя навигация
│   └── item-list/       # Список элементов
├── features/            # Бизнес-функции
│   ├── addItem/         # Фича добавления вещей
│   │   ├── model/       # Бизнес-логика
│   │   └── ui/          # UI компоненты фичи
│   ├── viewItems/       # Фича просмотра вещей
│   ├── searchItems/     # Фича поиска
│   ├── favoriteItem/    # Фича избранного
│   └── deleteItem/      # Фича удаления
├── entities/            # Бизнес-сущности
│   ├── item/            # Сущность "Вещь"
│   └── tag/             # Сущность "Тег"
├── shared/              # Переиспользуемый код
│   ├── api/             # API запросы
│   ├── ui/              # UI компоненты
│   │   ├── button/      # Кнопка
│   │   ├── emptyState/  # Пустое состояние
│   │   ├── itemCard/    # Карточка вещи
│   │   └── tag/         # Тег
│   ├── lib/             # Утилиты и библиотеки
│   ├── types/           # Общие типы
│   └── utils/           # Вспомогательные функции
├── hooks/               # Кастомные хуки
├── storage/             # Локальное хранилище
└── types/               # Глобальные типы TypeScript
```

## Слои архитектуры

### 1. app (Приложение)

**Ответственность**: Инициализация приложения, глобальные провайдеры, роутинг.

**Содержимое**:

- Корневые компоненты (`_layout.tsx`, `App.tsx`)
- Глобальные провайдеры (React Query, Context)
- Глобальные стили
- Навигационные настройки

**Правила импортов**: Может импортировать из всех слоев.

### 2. pages (Страницы)

**Ответственность**: Композиция виджетов и фич для конкретных страниц.

**Содержимое**:

- Страничные компоненты
- Композиция виджетов
- Навигационная логика

**Правила импортов**: Может импортировать из `widgets`, `features`, `entities`, `shared`.

### 3. widgets (Виджеты)

**Ответственность**: Крупные переиспользуемые UI блоки, комбинирующие несколько фич.

**Содержимое**:

- Поисковая панель с фильтрами
- Список элементов с пагинацией
- Навигационные компоненты
- Модальные окна

**Правила импортов**: Может импортировать из `features`, `entities`, `shared`.

### 4. features (Фичи)

**Ответственность**: Конкретные бизнес-функции приложения.

**Структура фичи**:

```
featureName/
├── model/           # Бизнес-логика
│   ├── hooks/       # Кастомные хуки фичи
│   ├── types/       # Типы фичи
│   └── index.ts     # Публичный API фичи
├── ui/              # UI компоненты фичи
└── index.ts         # Реэкспорт публичного API
```

**Правила импортов**: Может импортировать из `entities`, `shared`.

### 5. entities (Сущности)

**Ответственность**: Бизнес-сущности и их базовые операции.

**Содержимое**:

- Модели данных (Item, Tag, User)
- Базовые CRUD операции
- Валидация сущностей

**Правила импортов**: Может импортировать только из `shared`.

### 6. shared (Общее)

**Ответственность**: Переиспользуемый код, не связанный с бизнес-логикой.

**Слои shared**:

- `api/` - HTTP запросы, работа с внешними API
- `ui/` - Переиспользуемые UI компоненты (Button, Input, Modal)
- `lib/` - Сторонние библиотеки, утилиты
- `types/` - Общие типы TypeScript
- `utils/` - Чистые функции-утилиты

**Правила импортов**: Не импортирует другие слои (кроме других частей shared).

## Принципы разработки

### SOLID принципы

#### Single Responsibility Principle (SRP)

Каждый модуль имеет одну ответственность:

- Компонент отвечает только за UI
- Хук отвечает только за логику
- Сервис отвечает только за API

#### Open/Closed Principle (OCP)

Модули открыты для расширения, закрыты для модификации:

- Новые фичи добавляются как новые модули
- Существующий код не изменяется

#### Dependency Inversion Principle (DIP)

Зависимости направлены от верхних слоев к нижним:

- `pages` зависит от `widgets`, `features`
- `widgets` зависит от `features`, `entities`
- `features` зависит от `entities`, `shared`

### DRY (Don't Repeat Yourself)

Избегать дублирования кода:

- Переиспользуемые компоненты в `shared/ui/`
- Общая логика в кастомных хуках
- Утилиты в `shared/utils/`

### KISS (Keep It Simple)

Простота решений:

- Маленькие, focused компоненты
- Четкие интерфейсы
- Минимальная сложность

## Система типов

### Глобальные типы (`src/types/index.ts`)

```typescript
export interface Item {
  id: string;
  name: string;
  photos: string[];
  price: number;
  tags: Tag[];
  // ...
}

export interface Tag {
  id: string;
  name: string;
  color: string;
  // ...
}

export interface AppData {
  items: Item[];
  tags: Tag[];
  // ...
}
```

### Типы фич

Каждая фича может иметь свои типы в `features/[feature]/model/types.ts`

### UI типы

Общие UI типы в `shared/types/ui.ts`

## Управление состоянием

### React Query для серверного состояния

- Кэширование данных
- Синхронизация с AsyncStorage
- Оптимистичные обновления

### Context API для клиентского состояния

- Глобальное состояние приложения
- Настройки пользователя
- UI состояние

### Локальное состояние

- useState для компонентного состояния
- useReducer для сложной логики

## API и данные

### API слой (`src/shared/api/`)

```typescript
// wardrobeApi.ts
export const fetchWardrobeData = async (): Promise<AppData> => {
  const data = await storage.loadData();
  return data ?? DEFAULT_APP_DATA;
};

export const saveWardrobeData = async (data: AppData): Promise<void> => {
  await storage.saveData(data);
};
```

### Хранилище (`src/storage/`)

- AsyncStorage для мобильных устройств
- Локальное состояние для демо-данных

## Тестирование

### Unit тесты

- Компоненты: тестирование рендеринга
- Хуки: тестирование логики
- Утилиты: тестирование функций

### Integration тесты

- Фичи: end-to-end сценарии
- API: интеграция с хранилищем

### E2E тесты (будущие)

- Полные пользовательские сценарии

## CI/CD и качество кода

### ESLint + Prettier

Автоматическое форматирование и проверка качества кода.

### Husky + lint-staged

Pre-commit хуки для проверки качества.

### Code Review

Обязательный code review для всех изменений.

## Планы развития

### Краткосрочные (1-3 месяца)

- Добавление тестов
- Улучшение UI/UX
- Оптимизация производительности

### Среднесрочные (3-6 месяцев)

- Добавление новых фич (фото, категории)
- Синхронизация с облаком
- Push-уведомления

### Долгосрочные (6+ месяцев)

- Web версия
- Социальные функции
- AI рекомендации

## Соглашения об именовании

Подробные правила именования описаны в [`NAMING_GUIDELINES.md`](./NAMING_GUIDELINES.md).

## Контрибьютинг

### Добавление новой фичи

1. Создать новую папку в `features/`
2. Реализовать бизнес-логику в `model/`
3. Создать UI компоненты в `ui/`
4. Добавить публичный API в `index.ts`
5. Интегрировать в соответствующие страницы/widgets

### Добавление UI компонента

1. Создать папку в `shared/ui/[componentName]/`
2. Реализовать компонент в `[ComponentName].tsx`
3. Экспортировать в `index.ts`
4. Добавить в основной `shared/ui/index.ts`

### Модификация архитектуры

Любые изменения архитектуры требуют:

1. Обсуждения с командой
2. Обновления этой документации
3. Миграции существующего кода

---

## Контакты

Для вопросов по архитектуре:

- **Технический лидер**: [Ваше имя]
- **Документация**: Обновляется в этом файле
- **Code Review**: Обязательно для всех PR
